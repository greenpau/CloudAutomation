{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "This template creates a VPC",
    "Resources": {
        "CloudVpc0": {
            "Properties": {
                "CidrBlock": "10.1.0.0/16",
                "EnableDnsHostnames": "true",
                "EnableDnsSupport": "true",
                "Tags": [
                    {
                        "Key": "Description",
                        "Value": "IP address range for VPC Subnets"
                    }
                ]
            },
            "Type": "AWS::EC2::VPC"
        },
        "VpcSubnet0": {
            "Properties": {
                "AvailabilityZone": "us-west-2a",
                "CidrBlock": "10.1.0.0/24",
                "Tags": [
                    {
                        "Key": "Description",
                        "Value": "IP address range for Subnet 0 in VPC Network"
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::Subnet"
        },
        "VpcSubnet128": {
            "Properties": {
                "AvailabilityZone": "us-west-2c",
                "CidrBlock": "10.1.128.0/24",
                "Tags": [
                    {
                        "Key": "Description",
                        "Value": "IP address range for Subnet 128 in VPC Network"
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::Subnet"
        },
        "VpcSubnet64": {
            "Properties": {
                "AvailabilityZone": "us-west-2b",
                "CidrBlock": "10.1.64.0/24",
                "Tags": [
                    {
                        "Key": "Description",
                        "Value": "IP address range for Subnet 64 in VPC Network"
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::Subnet"
        },
        "VpnEndpoint0": {
            "Properties": {
                "BgpAsn": "65000",
                "IpAddress": "20.20.20.20",
                "Tags": [
                    {
                        "Key": "Description",
                        "Value": "Corporate VPN"
                    }
                ],
                "Type": "ipsec.1"
            },
            "Type": "AWS::EC2::CustomerGateway"
        },
        "VpnEndpoint0VPNConnection": {
            "Properties": {
                "CustomerGatewayId": {
                    "Ref": "VpnEndpoint0"
                },
                "StaticRoutesOnly": "true",
                "Type": "ipsec.1",
                "VpnGatewayId": {
                    "Ref": "VpnEndpoint0VPNGateway"
                }
            },
            "Type": "AWS::EC2::VPNConnection"
        },
        "VpnEndpoint0VPNConnectionRoute1": {
            "Properties": {
                "DestinationCidrBlock": "10.2.0.0/16",
                "VpnConnectionId": {
                    "Ref": "VpnEndpoint0VPNConnection"
                }
            },
            "Type": "AWS::EC2::VPNConnectionRoute"
        },
        "VpnEndpoint0VPNConnectionRoute2": {
            "Properties": {
                "DestinationCidrBlock": "10.3.0.0/16",
                "VpnConnectionId": {
                    "Ref": "VpnEndpoint0VPNConnection"
                }
            },
            "Type": "AWS::EC2::VPNConnectionRoute"
        },
        "VpnEndpoint0VPNGateway": {
            "Properties": {
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    }
                ],
                "Type": "ipsec.1"
            },
            "Type": "AWS::EC2::VPNGateway"
        },
        "VpnEndpoint0VPNGatewayAttachment": {
            "Properties": {
                "VpcId": {
                    "Ref": "CloudVpc0"
                },
                "VpnGatewayId": {
                    "Ref": "VpnEndpoint0VPNGateway"
                }
            },
            "Type": "AWS::EC2::VPCGatewayAttachment"
        }
    }
}
