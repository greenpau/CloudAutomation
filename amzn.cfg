{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "This template creates a VPC",
    "Resources": {
        "CloudVpc0": {
            "Properties": {
                "CidrBlock": "10.1.0.0/16",
                "EnableDnsHostnames": "true",
                "EnableDnsSupport": "true",
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    },
                    {
                        "Key": "Description",
                        "Value": "IP address range for VPC Subnets"
                    },
                    {
                        "Key": "Name",
                        "Value": "CORE-VPC-NET"
                    }
                ]
            },
            "Type": "AWS::EC2::VPC"
        },
        "InternetGateway0": {
            "Properties": {
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    },
                    {
                        "Key": "Description",
                        "Value": "Amazon Internet Gateway"
                    },
                    {
                        "Key": "Name",
                        "Value": "AWS-GATEWAY"
                    }
                ]
            },
            "Type": "AWS::EC2::InternetGateway"
        },
        "InternetGateway0Route0": {
            "Properties": {
                "DestinationCidrBlock": "0.0.0.0/0",
                "GatewayId": {
                    "Ref": "InternetGateway0"
                },
                "RouteTableId": {
                    "Ref": "RouteTable0"
                }
            },
            "Type": "AWS::EC2::Route"
        },
        "InternetGateway0VPCGatewayAttachment0": {
            "Properties": {
                "InternetGatewayId": {
                    "Ref": "InternetGateway0"
                },
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::VPCGatewayAttachment"
        },
        "RouteTable0": {
            "Properties": {
                "Tags": [
                    {
                        "Key": "VRF",
                        "Value": "Main"
                    },
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::RouteTable"
        },
        "RouteTable0Association0": {
            "Properties": {
                "RouteTableId": {
                    "Ref": "RouteTable0"
                },
                "SubnetId": {
                    "Ref": "VpcSubnet0"
                }
            },
            "Type": "AWS::EC2::SubnetRouteTableAssociation"
        },
        "RouteTable0Association1": {
            "Properties": {
                "RouteTableId": {
                    "Ref": "RouteTable0"
                },
                "SubnetId": {
                    "Ref": "VpcSubnet128"
                }
            },
            "Type": "AWS::EC2::SubnetRouteTableAssociation"
        },
        "RouteTable0Association2": {
            "Properties": {
                "RouteTableId": {
                    "Ref": "RouteTable0"
                },
                "SubnetId": {
                    "Ref": "VpcSubnet64"
                }
            },
            "Type": "AWS::EC2::SubnetRouteTableAssociation"
        },
        "VpcSubnet0": {
            "Properties": {
                "AvailabilityZone": "us-west-2a",
                "CidrBlock": "10.1.0.0/24",
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    },
                    {
                        "Key": "Description",
                        "Value": "IP address range for Subnet 0 in VPC Network"
                    },
                    {
                        "Key": "Name",
                        "Value": "CORE-SUBNET-1"
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::Subnet"
        },
        "VpcSubnet128": {
            "Properties": {
                "AvailabilityZone": "us-west-2c",
                "CidrBlock": "10.1.128.0/24",
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    },
                    {
                        "Key": "Description",
                        "Value": "IP address range for Subnet 128 in VPC Network"
                    },
                    {
                        "Key": "Name",
                        "Value": "CORE-SUBNET-3"
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::Subnet"
        },
        "VpcSubnet64": {
            "Properties": {
                "AvailabilityZone": "us-west-2b",
                "CidrBlock": "10.1.64.0/24",
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    },
                    {
                        "Key": "Description",
                        "Value": "IP address range for Subnet 64 in VPC Network"
                    },
                    {
                        "Key": "Name",
                        "Value": "CORE-SUBNET-2"
                    }
                ],
                "VpcId": {
                    "Ref": "CloudVpc0"
                }
            },
            "Type": "AWS::EC2::Subnet"
        },
        "VpnEndpoint0": {
            "Properties": {
                "BgpAsn": "65000",
                "IpAddress": "20.20.20.20",
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    },
                    {
                        "Key": "Description",
                        "Value": "Corporate VPN"
                    },
                    {
                        "Key": "Name",
                        "Value": "CORP-VPN"
                    }
                ],
                "Type": "ipsec.1"
            },
            "Type": "AWS::EC2::CustomerGateway"
        },
        "VpnEndpoint0VPNConnection": {
            "Properties": {
                "CustomerGatewayId": {
                    "Ref": "VpnEndpoint0"
                },
                "StaticRoutesOnly": "true",
                "Type": "ipsec.1",
                "VpnGatewayId": {
                    "Ref": "VpnEndpoint0VPNGateway"
                }
            },
            "Type": "AWS::EC2::VPNConnection"
        },
        "VpnEndpoint0VPNConnectionRoute1": {
            "Properties": {
                "DestinationCidrBlock": "10.2.0.0/16",
                "VpnConnectionId": {
                    "Ref": "VpnEndpoint0VPNConnection"
                }
            },
            "Type": "AWS::EC2::VPNConnectionRoute"
        },
        "VpnEndpoint0VPNConnectionRoute2": {
            "Properties": {
                "DestinationCidrBlock": "10.3.0.0/16",
                "VpnConnectionId": {
                    "Ref": "VpnEndpoint0VPNConnection"
                }
            },
            "Type": "AWS::EC2::VPNConnectionRoute"
        },
        "VpnEndpoint0VPNGateway": {
            "Properties": {
                "Tags": [
                    {
                        "Key": "Application",
                        "Value": {
                            "Ref": "AWS::StackName"
                        }
                    }
                ],
                "Type": "ipsec.1"
            },
            "Type": "AWS::EC2::VPNGateway"
        },
        "VpnEndpoint0VPNGatewayAttachment": {
            "Properties": {
                "VpcId": {
                    "Ref": "CloudVpc0"
                },
                "VpnGatewayId": {
                    "Ref": "VpnEndpoint0VPNGateway"
                }
            },
            "Type": "AWS::EC2::VPCGatewayAttachment"
        }
    }
}
